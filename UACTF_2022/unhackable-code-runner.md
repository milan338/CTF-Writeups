From `pages/index.tsx`, we can see that when we click the 'Run Code' button, our javascript is stringified and sent to a 'run' api. We can see from the app source that this API is found in `pages/api/run.ts`. From here, we note that the API saves our javascript in `code`, and this is passed to `new Script(code)`. We can look this up online and find in the [nodejs documentation](https://nodejs.org/api/vm.html#class-vmscript) that this will compile our arbitrary javascript, and the `runInContext` method of this compiled script that is then called will execute our javascript in a nodejs VM on the server. We can also note that the flag is stored in `process.env.flag`.

Since from the frontend instructions we know that the server returns to us all `console.log` outputs, our first instinct might be to try running `console.log(process.env.flag)`, however this will just give us `ERROR process is not defined`. So, we need to somehow break out of this sandbox and get some code to run that has access to the `process` object. If we think to how the node VM works, looking at `run.ts`, the server passes `ctxObj` to the VM as its context in `createContext()`, and we can access it as `this` from within the sandbox. The key insight here is that this context object exists *outside* the VM. Because this is just a javascript object, it has a constructor `this.constructor` which is just the base object constructor, however this too has its constructor `this.constructor.constructor` - the function constructor. The function constructor is special because it takes a string as an argument and turns it into a function that we can use like eval. However, since we've walked up the constructor chain of the context object that exists *outside* the VM, this means that the function constructor and thus the returned function will *also* exist outside the VM. So, if we were to do something like `this.constructor.constructor('return process.platform')`, we would get a function *inside* the VM that has access to the process object, which is exactly what we wanted. Now, all we have to do is get the flag from within this function and pass that into `console.log`:

```js
console.log(this.constructor.constructor('return process.env.flag')());
```

And just like that, in the output box, we now have our flag.
